<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <!-- CSS only -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
        integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/d3d6f2df1f.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" href="index.css">
    <title>Document</title>
    <script th:inline="javascript">
        $(document).ready(function() {
            var users = /*[[${userList}]]*/ []; // Replace 'userList' with the correct model attribute name
            var followedUsers = /*[[${followed}]]*/ [];
            $("#searchInput").on("keyup", function() {
                var searchQuery = $(this).val().toLowerCase();
                var searchResults = [];

                // Filter the users based on the search query
                searchResults = users.filter(function(user) {
                    var userName = user.name.toLowerCase();
                    return userName.indexOf(searchQuery) > -1;
                });
                // Clear previous search results
                $("#searchResults").empty();

                // Display the search results
                if (searchQuery.trim().length > 0 && searchResults.length > 0) {
                    var dropdownContent = $("<div>").addClass("dropdown-content");
                    $.each(searchResults, function(index, result) {
                        var userDiv = $("<div>").addClass("d-flex flex-row justify-content-between align-items-center mt-3 mb-3");
                        var profileDiv = $("<div>").addClass("d-flex flex-row align-items-center");
                        var profileImgDiv = $("<div>").addClass("rounded-circle overflow-hidden d-flex justify-content-center align-items-center border sugest-profile-photo");
                        var profileImg = $("<img>").addClass("profile-img").attr("src", result.profileUrl).css({"transform": "scale(1.5)", "width": "100%", "position": "absolute", "left": "0"});
                        var usernameStrong = $("<strong>").addClass("ml-3 sugest-username").text(result.username);
                        var followButton = $("<button>").addClass("btn btn-primary btn-sm p-0 btn-ig").text("Follow");

                        if (followedUsers.includes(result.id)) {
                            followButton.text("Following");
                        } else {
                            followButton.text("Follow");
                        }

                        followButton.on("click", function() {
                            var isFollowing = $(this).text() === "Following";
                            followUser(result.id, isFollowing, $(this));
                        });

                        profileImgDiv.append(profileImg);
                        profileDiv.append(profileImgDiv, usernameStrong);
                        userDiv.append(profileDiv, followButton);

                        $("#searchResults").append(userDiv);
                    });

                    $("#searchResults").show();
                } else {
                    $("#searchResults").hide();
                }
            });

            function followUser(userId, isFollowing, followButton) {
                var action = isFollowing ? "unfollowuser" : "followuser";
                var text = isFollowing ? "Follow" : "Following";

                $.ajax({
                    type: "POST",
                    url: "/" + action,
                    data: JSON.stringify({ userId: userId }),
                    contentType: "application/json",
                    success: function(response) {
                        // Handle success response
                        followButton.text(text);
                    },
                    error: function(xhr, status, error) {
                        // Handle error response
                        console.error("Error following/unfollowing user:", error);
                        // You can display an error message or perform any error handling as needed
                    }
                });
            }
        });

        function validateImageFiles(input) {
            if (input.files.length > 10) {
                input.setCustomValidity('You can upload a maximum of 10 images.');
            } else {
                input.setCustomValidity('');
            }
        }

        //like[pst
        $(document).ready(function() {
            $(".like-icon").on("click", function() {
                var icon = $(this);
                var postId = icon.data("postId");

                // Make the AJAX request to like the post
                $.ajax({
                    type: "POST",
                    url: "/likepost",
                    data: JSON.stringify({ postId: postId }),
                    contentType: "application/json",
                    success: function(response) {
                        // Handle success response
                        icon.css("fill", "red");
                    },
                    error: function(xhr, status, error) {
                        // Handle error response
                        console.error("Error liking post:", error);
                        // You can display an error message or perform any error handling as needed
                    }
                });
            });
        });

    </script>
</head>

<body>

    <div>
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="container justify-content-center">
                <div class="d-flex flex-row justify-content-between align-items-center col-9">
                    <a class="navbar-brand" href="#">
                        <img src="assets/images/ig-logo.png" alt="" loading="lazy">
                    </a>
                    <div>
                        <form class="form-inline my-2 my-lg-0">
                            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                        </form>
                    </div>
                    <div class="d-flex flex-row">
                        <ul class="list-inline m-0">
                            <li class="list-inline-item">
                                <a href="#" class="link-menu">
                                    <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-house-door-fill"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M6.5 10.995V14.5a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5h-4a.5.5 0 0 1-.5-.5V11c0-.25-.25-.5-.5-.5H7c-.25 0-.5.25-.5.495z" />
                                        <path fill-rule="evenodd"
                                            d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z" />
                                    </svg>
                                </a>
                            </li>
                            <li class="list-inline-item ml-2">
                                <a href="#" class="link-menu">
                                    <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-inboxes"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd"
                                            d="M.125 11.17A.5.5 0 0 1 .5 11H6a.5.5 0 0 1 .5.5 1.5 1.5 0 0 0 3 0 .5.5 0 0 1 .5-.5h5.5a.5.5 0 0 1 .496.562l-.39 3.124A1.5 1.5 0 0 1 14.117 16H1.883a1.5 1.5 0 0 1-1.489-1.314l-.39-3.124a.5.5 0 0 1 .121-.393zm.941.83l.32 2.562a.5.5 0 0 0 .497.438h12.234a.5.5 0 0 0 .496-.438l.32-2.562H10.45a2.5 2.5 0 0 1-4.9 0H1.066zM3.81.563A1.5 1.5 0 0 1 4.98 0h6.04a1.5 1.5 0 0 1 1.17.563l3.7 4.625a.5.5 0 0 1-.78.624l-3.7-4.624A.5.5 0 0 0 11.02 1H4.98a.5.5 0 0 0-.39.188L.89 5.812a.5.5 0 1 1-.78-.624L3.81.563z" />
                                        <path fill-rule="evenodd"
                                            d="M.125 5.17A.5.5 0 0 1 .5 5H6a.5.5 0 0 1 .5.5 1.5 1.5 0 0 0 3 0A.5.5 0 0 1 10 5h5.5a.5.5 0 0 1 .496.562l-.39 3.124A1.5 1.5 0 0 1 14.117 10H1.883A1.5 1.5 0 0 1 .394 8.686l-.39-3.124a.5.5 0 0 1 .121-.393zm.941.83l.32 2.562A.5.5 0 0 0 1.884 9h12.234a.5.5 0 0 0 .496-.438L14.933 6H10.45a2.5 2.5 0 0 1-4.9 0H1.066z" />
                                    </svg>
                                </a>
                            </li>
                            <li class="list-inline-item ml-2">
                                <a href="#" class="link-menu">
                                    <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-compass"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd"
                                            d="M8 15.016a6.5 6.5 0 1 0 0-13 6.5 6.5 0 0 0 0 13zm0 1a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15z" />
                                        <path
                                            d="M6 1a1 1 0 0 1 1-1h2a1 1 0 0 1 0 2H7a1 1 0 0 1-1-1zm.94 6.44l4.95-2.83-2.83 4.95-4.95 2.83 2.83-4.95z" />
                                    </svg>
                                </a>
                            </li>
                            <li class="list-inline-item ml-2">
                                <a href="#" class="link-menu">
                                    <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-heart"
                                        fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd"
                                            d="M8 2.748l-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z" />
                                    </svg>
                                </a>
                            </li>

                            <li class="list-inline-item ml-2 align-middle">
                                <a href="#" class="link-menu">
                                    <div
                                        class="rounded-circle overflow-hidden d-flex justify-content-center align-items-center border topbar-profile-photo">
                                        <img th:src="${feedDto.profileUrl}" alt="..."
                                            style="transform: scale(1.5); width: 100%; position: absolute; left: 0;">
                                    </div>
                                </a>

                            </li>
                            <li class="list-inline-item ml-2">
                                <form action="/logout" method="post">
                                    <button class="btn btn-light" type="submit">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-right" viewBox="0 0 16 16">
                                        <path fill-rule="evenodd" d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z"/>
                                        <path fill-rule="evenodd" d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z"/>
                                    </svg>
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>
    </div>

    <div class="mt-4">
        <div class="container d-flex justify-content-center">
            <div class="col-9">
                <div class="row">
                    <div class="col-8">
                        <div class="create">
                            <button type="button" class="btn btn-light" data-toggle="modal" data-target="#createPost" data-whatever="@getbootstrap">Create Post</button>
                            <button type="button" class="btn btn-light" data-toggle="modal" data-target="#createStory" data-whatever="@getbootstrap">Add Story</button>
                            <div class="modal fade" id="createPost" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLabel">New Post</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <form action="#" id="addPostForm" th:action="@{/addpost}" method="post" th:object="${addPostDto}" enctype="multipart/form-data">
                                                <div class="form-group">
                                                    <label for="addPostContent" class="col-form-label">Content :</label>
                                                    <input th:field="*{content}" type="text" class="form-control" id="addPostContent">
                                                </div>
                                                <div class="form-group">
                                                    <label for="imageFiles" class="col-form-label">Add Images : </label>
                                                    <input type="file" id="imageFiles" name="imageFiles" multiple onchange="validateImageFiles(this)" />
                                                </div>
                                            </form>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                            <button type="submit" form="addPostForm" class="btn btn-primary">Post</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal fade" id="createStory" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="exampleModalLabel">New Story</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">
                                            <form th:action="@{/addstory}" method="post" enctype="multipart/form-data" id="addStoryForm">
                                                <div class="form-group">
                                                    <label for="storyImg" class="col-form-label">Story:</label>
                                                    <input type="file" id="storyImg" name="storyImg" multiple />
                                                </div>
                                            </form>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                            <button type="submit" form="addStoryForm" class="btn btn-primary">Add Story</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- START OF STORIES -->
                        <div class="card">
                            <div  class="card-body d-flex justify-content-start">
                                <ul th:each="story:${feedDto.storyFeedDtos}" class="list-unstyled mb-0">
                                    <li class="list-inline-item">
                                        <button data-toggle="modal" th:attr="data-target='#storymodel-' + ${story.id}" class="btn p-0 m-0">
                                            <div class="d-flex flex-column align-items-center">
                                                <div
                                                    class="rounded-circle overflow-hidden d-flex justify-content-center align-items-center border border-danger story-profile-photo">
                                                    <img th:src="${story.profileUrl}" alt="..."
                                                        style="transform: scale(1.5); width: 100%; position: absolute; left: 0;">
                                                </div>
                                                <small th:text="${story.username}"></small>
                                            </div>
                                        </button>


                                        <div class="modal fade" th:attr="id='storymodel-' + ${story.id}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5  class="modal-title" id="exampleModalLabel"> <span th:text="${story.username}"></span> Story</h5>
                                                        <div class="ml-auto d-flex justify-content-end" >
                                                        <span  th:if="${feedDto.username == story.username}">
                                                            <button type="submit" class="btn btn-light" data-toggle="modal" data-whatever="@getbootstrap"  th:attr="form='deleteStoryForm-' + ${story.id}">

                                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                                                    <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"></path>
                                                                </svg>
                                                            </button>
                                                            <form action="#" th:attr="id='deleteStoryForm-' + ${story.id}" th:action="@{/deletestory}" method="post" >
                                                                <input th:value="${story.id}" name="storyId" type="hidden" class="form-control" >
                                                             </form>
                                                        </span>
                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                <span aria-hidden="true">&times;</span>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="modal-body">
                                                        <div  class="embed-responsive embed-responsive-1by1">
                                                            <img class="embed-responsive-item" th:src="${story.imgUrl}" alt="story-img" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                    </li>
                                 </ul>
                            </div>
                        </div>
                        <!-- END OF STORIES -->

                        <!-- START OF POSTS -->
                        <div class="d-flex flex-column mt-4 mb-4">

                            <div th:each="post, carouselIndex:${feedDto.postFeedDtos}"  class="card">
                                <div class="card-header p-3">
                                    <div class="d-flex flex-row align-items-center">
                                        <div
                                            class="rounded-circle overflow-hidden d-flex justify-content-center align-items-center border border-danger post-profile-photo mr-3">
                                            <img th:src="${post.profileUrl}" alt="..."
                                                style="transform: scale(1.5); width: 100%; position: absolute; left: 0;">
                                        </div>
                                        <span th:text="${post.username}"  class="font-weight-bold"></span>
                                        <span class="ml-auto" th:if="${feedDto.username == post.username}">
                                            <button type="button" class="btn btn-light" data-toggle="modal" th:attr="data-target='#editpost-' + ${post.id}" data-whatever="@getbootstrap">

                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="ml-auto bi bi-pencil-square" viewBox="0 0 16 16" >
                                                <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                                <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                            </svg>
                                            </button>
                                            <button type="button" class="btn btn-light" data-toggle="modal" th:attr="data-target='#deletepost-' + ${post.id}" data-whatever="@getbootstrap">

                                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                                    <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
                                                </svg>
                                            </button>
                                        </span>
                                        <div class="modal fade" th:attr="id='editpost-' + ${post.id}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="exampleModalLabel">Edit Post</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <form action="#" th:attr="id='editPostForm-' + ${post.id}" th:action="@{/editpost}" method="post" enctype="multipart/form-data">
                                                            <div class="form-group">
                                                                <label for="editPostContent" class="col-form-label">Content :</label>
                                                                <input th:value="${post.content}" name="content" type="text" class="form-control" id="editPostContent">
                                                            </div>
                                                            <div class="form-group">
                                                                <label for="imageFiles" class="col-form-label">Add Images : </label>
                                                                <input type="file" id="imageFiles" name="imageFiles" multiple />
                                                            </div>
                                                            <input th:value="${post.id}" name="postId" type="hidden" class="form-control" id="">
                                                        </form>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                        <button type="submit" th:attr="form='editPostForm-' + ${post.id}" class="btn btn-primary">Post</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal fade" th:attr="id='deletepost-' + ${post.id}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="exampleModalLabel">Edit Post</h5>
                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                            <span aria-hidden="true">&times;</span>
                                                        </button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <form action="#" th:attr="id='deletePostForm-' + ${post.id}" th:action="@{/deletepost}" method="post" >
                                                            <h2>Are you sure you want to delete this post?</h2>
                                                            <input th:value="${post.id}" name="postId" type="hidden" class="form-control" id="">
                                                        </form>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                        <button type="submit" th:attr="form='deletePostForm-' + ${post.id}" class="btn btn-primary">Delete</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <div class="card-body p-0" >


                                            <div th:attr="id='carouselExampleIndicators-'+ ${carouselIndex.index}" class="carousel slide " data-ride="carousel">

                                                <div class="carousel-inner " th:each="postImage,iterStat:${post.postImages}" >
                                                    <div class= "carousel-item" th:classappend="${iterStat.index == 0} ? 'active'">
                                                        <img  class="d-block w-100" th:src="${postImage.imageUrl}" alt="post-img"/>
                                                    </div>
                                                </div>
                                                <a class="carousel-control-prev" th:attr="href='#carouselExampleIndicators-'+ ${carouselIndex.index}" role="button" data-slide="prev">
                                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                                    <span class="sr-only">Previous</span>
                                                </a>
                                                <a class="carousel-control-next" th:attr="href='#carouselExampleIndicators-'+ ${carouselIndex.index}" role="button" data-slide="next">
                                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                                    <span class="sr-only">Next</span>
                                                </a>


                                    </div>


                                    <div class="d-flex flex-row justify-content-between pl-3 pr-3 pt-3 pb-1">
                                        <ul class="list-inline d-flex flex-row align-items-center m-0">
                                            <li class="list-inline-item">
                                                <form action="#" th:action="@{/likepost}" method="post">
                                                <button class="btn p-0">
                                                    <svg th:attr="id='likePost-'+ ${post.id}" data-postId="${post.id}" width="1.6em" height="1.6em" viewBox="0 0 16 16"
                                                        class="bi bi-heart" fill="currentColor"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd"
                                                            d="M8 2.748l-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z" />
                                                    </svg>
                                                </button>
                                                    <input th:value="${post.id}" name="postId" type="hidden">
                                                </form>
                                            </li>
                                            <li class="list-inline-item ml-2">
                                                <button class="btn p-0">
                                                    <svg width="1.6em" height="1.6em" viewBox="0 0 16 16"
                                                        class="bi bi-chat" fill="currentColor"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd"
                                                            d="M2.678 11.894a1 1 0 0 1 .287.801 10.97 10.97 0 0 1-.398 2c1.395-.323 2.247-.697 2.634-.893a1 1 0 0 1 .71-.074A8.06 8.06 0 0 0 8 14c3.996 0 7-2.807 7-6 0-3.192-3.004-6-7-6S1 4.808 1 8c0 1.468.617 2.83 1.678 3.894zm-.493 3.905a21.682 21.682 0 0 1-.713.129c-.2.032-.352-.176-.273-.362a9.68 9.68 0 0 0 .244-.637l.003-.01c.248-.72.45-1.548.524-2.319C.743 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.52.263-1.639.742-3.468 1.105z" />
                                                    </svg>
                                                </button>
                                            </li>
                                            <li class="list-inline-item ml-2">
                                                <button class="btn p-0">
                                                    <svg width="1.6em" height="1.6em" viewBox="0 0 16 16"
                                                        class="bi bi-share" fill="currentColor"
                                                        xmlns="http://www.w3.org/2000/svg">
                                                        <path fill-rule="evenodd"
                                                            d="M11.724 3.947l-7 3.5-.448-.894 7-3.5.448.894zm-.448 9l-7-3.5.448-.894 7 3.5-.448.894z" />
                                                        <path fill-rule="evenodd"
                                                            d="M13.5 4a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm0 1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zm0 10a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm0 1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5zm-11-6.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm0 1a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z" />
                                                    </svg>
                                                </button>
                                            </li>
                                        </ul>
                                        <div>
                                            <button class="btn p-0">
                                                <svg width="1.6em" height="1.6em" viewBox="0 0 16 16" class="bi bi-hdd"
                                                    fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd"
                                                        d="M14 9H2a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-1a1 1 0 0 0-1-1zM2 8a2 2 0 0 0-2 2v1a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-1a2 2 0 0 0-2-2H2z" />
                                                    <path
                                                        d="M5 10.5a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0zm-2 0a.5.5 0 1 1-1 0 .5.5 0 0 1 1 0z" />
                                                    <path fill-rule="evenodd"
                                                        d="M4.094 4a.5.5 0 0 0-.44.26l-2.47 4.532A1.5 1.5 0 0 0 1 9.51v.99H0v-.99c0-.418.105-.83.305-1.197l2.472-4.531A1.5 1.5 0 0 1 4.094 3h7.812a1.5 1.5 0 0 1 1.317.782l2.472 4.53c.2.368.305.78.305 1.198v.99h-1v-.99a1.5 1.5 0 0 0-.183-.718L12.345 4.26a.5.5 0 0 0-.439-.26H4.094z" />
                                                </svg>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="pl-3 pr-3 pb-2">
                                        <strong class="d-block" th:text="${post.likes} + ' likes'"></strong>
                                        <strong th:text="${post.username}" class="d-block"></strong>
                                        <p th:text="${post.content}" class="d-block mb-1"></p>
                                        <button class="btn p-0">
                                            <span class="text-muted">View all 20 comments</span>
                                        </button>

                                        <div th:each="postComment: ${post.postFeedComments}">
                                            <div>
                                                <strong th:text="${postComment.username}" class="d-block"></strong>
                                                <div class="d-flex flex-row align-items-center">
                                                    <span th:text="${postComment.content}"></span>
                                                    <span class="ml-auto"  th:if="${feedDto.username == post.username}">
                                                        <button type="button" class="btn btn-light" data-toggle="modal" data-whatever="@getbootstrap"  th:attr="data-target='#editcomment-' + ${postComment.id}">

                                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="ml-auto bi bi-pencil-square" viewBox="0 0 16 16">
                                                                <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"></path>
                                                                <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"></path>
                                                            </svg>
                                                        </button>
                                                        <button type="button" class="btn btn-light" data-toggle="modal" data-whatever="@getbootstrap"  th:attr="data-target='#deletecomment-' + ${postComment.id}">

                                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
                                                            <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"></path>
                                                        </svg>
                                                    </button>
                                                    </span>

                                                    <div class="modal fade" th:attr="id='editcomment-' + ${postComment.id}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="exampleModalLabel">Edit Comment</h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <form action="#" th:attr="id='editCommentForm-' + ${postComment.id}" th:action="@{/editcomment}" method="post" >
                                                                        <div class="form-group">
                                                                            <label for="editCommentContent" class="col-form-label">Content :</label>
                                                                            <input th:value="${postComment.content}" name="content" type="text" class="form-control" id="editCommentContent">
                                                                        </div>
                                                                        <input th:value="${postComment.id}" name="commentid" type="hidden" class="form-control" >
                                                                    </form>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                                                    <button type="submit" th:attr="form='editCommentForm-' + ${postComment.id}" class="btn btn-primary">Post</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal fade" th:attr="id='deletecomment-' + ${postComment.id}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="exampleModalLabel">Delete Comment</h5>
                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                        <span aria-hidden="true">&times;</span>
                                                                    </button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <form action="#" th:attr="id='deleteCommentForm-' + ${postComment.id}" th:action="@{/deletecomment}" method="post" >
                                                                        <h2>Are you sure you want to delete this Comment?</h2>
                                                                        <input th:value="${postComment.id}" name="commentid" type="hidden" class="form-control" >
                                                                    </form>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                                    <button type="submit" th:attr="form='deleteCommentForm-' + ${postComment.id}" class="btn btn-primary">Delete</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <small class="text-muted">4 HOURS AGO</small>
                                    </div>

                                    <div class="position-relative comment-box">
                                        <form th:action="@{/addcomment}"  method="post">
                                            <input name="content" id="addcommentcontent"  type="text" class="w-100 border-0 p-3 input-post" placeholder="Add a comment...">
                                            <input type="hidden" name="userid" th:value="${feedDto.userid}">
                                            <input type="hidden" name="postid" th:value="${post.id}">
                                            <button class="btn btn-primary position-absolute btn-ig">Post</button>
                                        </form>
                                    </div>


                                </div>
                            </div>

                        </div>
                        <!-- END OF POSTS -->
                    </div>
                    <div class="col-4">
                        <div class="d-flex flex-row align-items-center">
                            <div
                                class="rounded-circle overflow-hidden d-flex justify-content-center align-items-center border sidenav-profile-photo">
                                <img th:src="${feedDto.profileUrl}"  alt="..."
                                    style="transform: scale(1.5); width: 100%; position: absolute; left: 0;">
                            </div>
                            <div class="profile-info ml-3">
                                <span th:text="${feedDto.username} " class="profile-info-username"></span>
                                <span class="profile-info-name"></span>
                            </div>
                        </div>

                        <div class="mt-4">
                            <div class="d-flex flex-row justify-content-between">
                                <small class="text-muted font-weight-normal">Search Users</small>
                            </div>
                            <div>
                                    <div>
                                        <form class="form-inline my-2 my-lg-0">
                                            <input  id="searchInput" class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                                        </form>
                                        <div id="searchResults"></div>
                                    </div>
                            </div>
                            <div>
                                <div class="d-flex flex-row justify-content-between">
                                    <small class="text-muted font-weight-normal">User Requests</small>
                                </div>
                                <div id="requests" th:each="request:${userRequests}">
                                    <div class="d-flex flex-row justify-content-between align-items-center mt-3 mb-3">
                                        <div class="d-flex flex-row align-items-center">
                                            <div class="rounded-circle overflow-hidden d-flex justify-content-center align-items-center border sugest-profile-photo">
                                                <img class="profile-img" th:src="${request.profileUrl}" style="transform: scale(1.5); width: 100%; position: absolute; left: 0px;" alt="profile-img">
                                            </div>
                                            <strong th:text="${request.username}" class="ml-3 sugest-username"></strong>
                                        </div>
                                        <button class="btn btn-primary btn-sm p-0 btn-ig" type="submit" th:attr="form='acceptRequestForm-' + ${request.id}">Accept</button>
                                        <form action="#" th:attr="id='acceptRequestForm-' + ${request.id}" th:action="@{/acceptrequest}" method="post" >
                                                <input th:value="${request.id}" name="userid" type="hidden" >
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

<!--  Edit Post  -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
            integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
            crossorigin="anonymous"></script>
</body>

<footer>
    <!-- JS, Popper.js, and jQuery -->


</footer>

</html>